<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Flipbook</title>
  <style>
    body {
      background: #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      flex-direction: column;
    }
    #flipbook-container {
      width: 800px;
      height: 600px;
      overflow: hidden;
      position: relative;
    }
    #flipbook {
      width: 800px;
      height: 600px;
    }
    #flipbook .page {
      width: 400px;
      height: 600px;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      background-color: white;
      border: 1px solid black;
    }
    .controls {
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
  <!-- jQuery and turn.js from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/3/turn.min.js"></script>
</head>
<body>
  <div id="flipbook-container">
    <div id="flipbook">
      
        <div class="page" style="background-image: url('images/page1.jpg');"></div>
        <div class="page" style="background-image: url('images/page2.jpg');"></div>
        
        <div class="page" style="background-image: url('images/page3.jpg');"></div>
        <div class="page" style="background-image: url('images/page4.jpg');"></div>
        
    </div>
  </div>
  <div class="controls">
    <button onclick="$('#flipbook').turn('previous')">Previous</button>
    <button onclick="$('#flipbook').turn('next')">Next</button>
  </div>
  <script>
    $(document).ready(function() {
      var currentDisplay = null;
      
      // Determine the display mode based on orientation.
      function checkOrientation() {
        return window.matchMedia("(orientation: portrait)").matches ? "single" : "double";
      }

      // Initialize the flipbook.
      function initFlipbook(displayType) {
        currentDisplay = displayType;
        $("#flipbook").turn({
          width: 800,
          height: 600,
          autoCenter: true,
          display: displayType,
          elevation: 50,
          gradients: true,
          when: {
            turned: function(event, page) {
              console.log("Current page: " + page);
            }
          }
        });
      }

      // Reinitialize the flipbook when display mode changes.
      function reinitFlipbook(newDisplay) {
        var currentPage = $("#flipbook").turn("page");
        $("#flipbook").turn("destroy");
        initFlipbook(newDisplay);
        $("#flipbook").turn("page", currentPage);
      }

      // Initial setup.
      initFlipbook(checkOrientation());

      // Listen for window resize/orientation change.
      $(window).on("resize", function() {
        var newDisplay = checkOrientation();
        if(newDisplay !== currentDisplay) {
          reinitFlipbook(newDisplay);
        }
      });

      // Debug: Log the inline style for each page.
      $("#flipbook .page").each(function(index) {
        console.log("Page " + (index + 1) + " style:", $(this).attr("style"));
      });
    });
  </script>
</body>
</html>
